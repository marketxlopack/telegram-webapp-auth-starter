# Telegram WebApp Auth Starter (Next.js + TypeScript)

–ì–æ—Ç–æ–≤—ã–π –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–æ–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é –≤–∞–ª–∏–¥–∞—Ü–∏—é `initData` –∏–∑ Telegram WebApp –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.

## –ß—Ç–æ –≤–Ω—É—Ç—Ä–∏

- **/src/pages/index.tsx** ‚Äî —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –¥–ª—è Mini App: –∑–∞–±–∏—Ä–∞–µ—Ç `tg.initData` –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ `/api/auth/verify-init-data`
- **/src/pages/api/auth/verify-init-data.ts** ‚Äî —Å–µ—Ä–≤–µ—Ä–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ —Å–æ–≥–ª–∞—Å–Ω–æ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π —Å—Ö–µ–º–µ
- **/src/lib/telegram.ts** ‚Äî —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏ CORS
- **/src/pages/login.tsx** ‚Äî *–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ*: –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π Login Widget (–¥–ª—è –±—Ä–∞—É–∑–µ—Ä–∞ –≤–Ω–µ Telegram)
- **.env.local.example** ‚Äî –ø—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# 1) –°–∫–ª–æ–Ω–∏—Ä—É–π—Ç–µ –ø–∞–ø–∫—É –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
npm i

# 2) –°–æ–∑–¥–∞–π—Ç–µ .env.local –ø–æ –æ–±—Ä–∞–∑—Ü—É
cp .env.local.example .env.local
# –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ BOT_TOKEN –∏ –ø—Ä–∏ –∂–µ–ª–∞–Ω–∏–∏ BOT_USERNAME –∏ ALLOWED_ORIGINS

# 3) –ó–∞–ø—É—Å—Ç–∏—Ç–µ dev
npm run dev
```

–û—Ç–∫—Ä–æ–π—Ç–µ –±–æ—Ç–∞ –≤ Telegram, –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é `Start` —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º `web_app` (—á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É –≤ –º–µ–Ω—é –±–æ—Ç–∞), –∫–æ—Ç–æ—Ä–∞—è –≤–µ–¥—ë—Ç –Ω–∞ –≤–∞—à URL (`https://<host>/`).
–°—Ç—Ä–∞–Ω–∏—Ü–∞ –≤–Ω—É—Ç—Ä–∏ Telegram –≤—ã–∑–æ–≤–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫—É –ø–æ–¥–ø–∏—Å–∏ –∏ –≤–µ—Ä–Ω—ë—Ç JSON —Å –¥–∞–Ω–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

- `BOT_TOKEN` ‚Äî —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ –æ—Ç BotFather (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ).
- `ALLOWED_ORIGINS` ‚Äî —Å–ø–∏—Å–æ–∫ —Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã—Ö Origin –¥–ª—è CORS (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é). –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏: `http://localhost:3000`.
- `BOT_USERNAME` ‚Äî *—Ç–æ–ª—å–∫–æ* –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã `/login` (–∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –≤–∏–¥–∂–µ—Ç). –î–ª—è Mini App –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è.

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –Ω—é–∞–Ω—Å—ã

- –ü–æ–¥–ø–∏—Å—å —Å—á–∏—Ç–∞–µ—Ç—Å—è –∫–∞–∫ `HMAC_SHA256(data_check_string, secret_key)`, –≥–¥–µ `secret_key = SHA256(bot_token)`.
- `data_check_string` ‚Äî —ç—Ç–æ —Å—Ç—Ä–æ–∫–∏ `key=value` –∏–∑ `initData` (–∫—Ä–æ–º–µ `hash`), –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ –∫–ª—é—á—É –∏ —Å–∫–ª–µ–µ–Ω–Ω—ã–µ —Å–∏–º–≤–æ–ª–æ–º `\n`.
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä—è—Ç—å `auth_date` (–≤ –ø—Ä–∏–º–µ—Ä–µ: –Ω–µ —Å—Ç–∞—Ä—à–µ 24 —á–∞—Å–æ–≤).
- –ù–µ–ª—å–∑—è –¥–æ–≤–µ—Ä—è—Ç—å –¥–∞–Ω–Ω—ã–º –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ ‚Äî **–≤—Å–µ–≥–¥–∞** –≤–∞–ª–∏–¥–∏—Ä—É–π—Ç–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.
- –•—Ä–∞–Ω–∏—Ç–µ `BOT_TOKEN` —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–Ω–æ–π —Å—Ç–æ—Ä–æ–Ω–µ.

## –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–æ—Ç—É (–∫–Ω–æ–ø–∫–∞ Web App)

–í Telegram (—á–µ—Ä–µ–∑ BotFather) –¥–æ–±–∞–≤—å—Ç–µ –≤ –º–µ–Ω—é –±–æ—Ç–∞ –∫–Ω–æ–ø–∫—É Web App, —É–∫–∞–∂–∏—Ç–µ URL –≤–∞—à–µ–≥–æ –¥–µ–ø–ª–æ—è (–Ω–∞–ø—Ä–∏–º–µ—Ä Vercel).
–ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä–æ–µ—Ç Mini App —á–µ—Ä–µ–∑ —ç—Ç—É –∫–Ω–æ–ø–∫—É, –≤ `window.Telegram.WebApp` –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω `initData`.

## –î–µ–ø–ª–æ–π

- Vercel, Netlify, Render ‚Äî –ª—é–±–∞—è —Å—Ä–µ–¥–∞, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∞—è Next.js API Routes.
- –ù–µ –∑–∞–±—É–¥—å—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞ –ø—Ä–æ–¥–µ.

–£–¥–∞—á–∏! üöÄ
